% filepath: c:\Users\adurs\OneDrive\Documents\repos\repos\agopalareddy.github.io\files\cv_tex\reddy_cv.sty
% -----------------------------------------------------------------
% reddy_cv.sty - A professional and consistent CV style package
% Author: Aadarsha Gopala Reddy
% Last Updated: May 14, 2025
% -----------------------------------------------------------------
% This style package provides specialized environments for different 
% sections of a CV, ensuring each entry stays together on the same page
% and maintains consistent formatting throughout the document.
% -----------------------------------------------------------------

\ProvidesPackage{reddy_cv}[2025/05/14 CV Style Package for Aadarsha Gopala Reddy]

% -----------------------------------------------------------------
% Spacing Variables
% -----------------------------------------------------------------
% These lengths control the spacing between different elements
\newlength{\headerSpacing}  % Space between sections
\setlength{\headerSpacing}{3pt}

\newlength{\entrySpacing}   % Space between entries within a section
\setlength{\entrySpacing}{0.5\headerSpacing}

\newlength{\highlightSpacing}  % Space between bullet points or highlights
\setlength{\highlightSpacing}{0.25\headerSpacing}

\newlength{\kernSpacing}    % Horizontal spacing between inline elements
\setlength{\kernSpacing}{2.5pt}

% -----------------------------------------------------------------
% Required Packages
% -----------------------------------------------------------------
% Page layout and dimensions
\RequirePackage[
    ignoreheadfoot,     % Ignore header and footer in page dimensions
    top=1.2cm,          % Top margin
    bottom=1.2cm,       % Bottom margin
    left=1.2cm,         % Left margin
    right=1.3cm,        % Right margin (slightly increased)
    footskip=0.8cm,     % Space for footer
    showframe=false     % Don't show frame around the page
]{geometry}

% Other required packages
\RequirePackage{caption}      % For caption formatting
\RequirePackage{titlesec}     % For section title formatting
\RequirePackage{tabularx}     % For flexible tables
\RequirePackage{array}        % Enhanced table features
\RequirePackage[dvipsnames]{xcolor}  % For colors with predefined names
\RequirePackage{enumitem}     % For customizing lists
\RequirePackage{fontawesome5} % For icons
\RequirePackage{amsmath}      % For mathematical symbols and environments
\RequirePackage[
    pdftitle={Aadarsha's CV},
    pdfauthor={Aadarsha Gopala Reddy},
    pdfcreator={LaTeX with Custom CV Style},
    colorlinks=true,          % Color links instead of boxes
    urlcolor=primaryColor     % Color for URLs
]{hyperref}
\RequirePackage[pscoord]{eso-pic}  % For adding background elements
\RequirePackage{calc}         % For length calculations
\RequirePackage{bookmark}     % For PDF bookmarks
\RequirePackage{lastpage}     % For referencing the last page
\RequirePackage{changepage}   % For adjusting page layout mid-document
\RequirePackage{paracol}      % For parallel columns
\RequirePackage{ifthen}       % For conditional statements
\RequirePackage{needspace}    % For ensuring space before elements
\RequirePackage{iftex}        % For TeX engine detection
\RequirePackage{charter}      % For Charter font
\RequirePackage{qrcode}       % For generating QR codes

% -----------------------------------------------------------------
% Color Definitions
% -----------------------------------------------------------------
\definecolor{primaryColor}{RGB}{0, 0, 0}      % Black for primary text
\definecolor{accentColor}{RGB}{50, 50, 50}    % Dark gray for accents

% -----------------------------------------------------------------
% PDF Settings for ATS (Applicant Tracking Systems)
% -----------------------------------------------------------------
\ifPDFTeX
    \input{glyphtounicode}   % Maps glyphs to unicode for better copy-paste
    \pdfgentounicode=1       % Enable unicode mapping
    \RequirePackage[T1]{fontenc}         % Font encoding
    \RequirePackage[utf8]{inputenc}      % Input encoding
    \RequirePackage{lmodern}             % Modern fonts for better rendering
\fi

% -----------------------------------------------------------------
% General Document Settings
% -----------------------------------------------------------------
\raggedright           % Left-aligned text
\AtBeginEnvironment{adjustwidth}{\partopsep0pt}  % No extra space in adjustwidth
\pagestyle{empty}      % No page numbers or headers
\setcounter{secnumdepth}{0}  % No section numbering
\setlength{\parindent}{0pt}  % No paragraph indentation
\setlength{\topskip}{0pt}    % No extra space at top of page
\setlength{\columnsep}{0.1cm}  % Space between columns
\pagenumbering{gobble}       % Hide page numbers

% Improve hyphenation and word breaks
\sloppy                % Allow more space between words to prevent overfull boxes
\hyphenpenalty=1000    % Discourage but allow hyphenation
\pretolerance=150      % Be more tolerant of badly spaced lines
\tolerance=1000        % Allow looser spacing to prevent overfull boxes
\emergencystretch=1em  % Allow extra space if needed

% Allow URLs to break at any character
\def\UrlBreaks{\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]%
  \do\)\do\,\do\?\do\'\do+\do\=\do\#\do-\do\&}
\def\UrlBigBreaks{\do\:\do@\do\/\do\-}

% -----------------------------------------------------------------
% Section Formatting
% -----------------------------------------------------------------
% Format for section headings (e.g., EDUCATION, EXPERIENCE, etc.)
\titleformat{\section}
    {\needspace{3\baselineskip}\bfseries\large\color{accentColor}}  % Format
    {}                      % Label
    {0pt}                   % Sep between label and title
    {}                      % Before code
    [\vspace{0.5pt}\color{accentColor}\titlerule]  % After code (horizontal line)

\titlespacing{\section}{0pt}{0.1cm}{0.1cm}  % Spacing around section titles

% -----------------------------------------------------------------
% Basic Content Formatting
% -----------------------------------------------------------------
% Custom bullet point style
\renewcommand\labelitemi{$\vcenter{\hbox{\small$\bullet$}}$}

% Environment for bullet lists with minimal spacing
\newenvironment{highlightsforbulletentries}{
    \begin{itemize}[
        topsep=0.05cm,      % Space before the list
        parsep=0.05cm,      % Space between paragraphs within items
        partopsep=0pt,      % Extra space if list starts a paragraph
        itemsep=0pt,        % Space between items
        leftmargin=20pt     % Left margin of list
    ]
}{
    \end{itemize}
}

% Basic layout environments
\newenvironment{header}{
    \setlength{\topsep}{0pt}\par\kern\topsep\raggedright\linespread{1.5}
}{
    \par\kern\topsep
}

% -----------------------------------------------------------------
% Core Layout Environments (Used by specialized environments)
% -----------------------------------------------------------------
% Single column entry with consistent margins
\newenvironment{onecolentry}{
    \begin{adjustwidth}{0 cm + 0.00001 cm}{0 cm + 0.00001 cm}
}{
    \end{adjustwidth}
}

% Two-column entry with right column typically for dates
\newenvironment{twocolentry}[2][]{
    \onecolentry
    \def\secondColumn{#2}
    \setcolumnwidth{\fill, 4.5cm}
    \begin{paracol}{2}
}{
    \switchcolumn \raggedleft \secondColumn
    \end{paracol}
    \endonecolentry
}

% Special two-column entry for honors/awards section
\newenvironment{honorstwocolentry}[2][]{
    \onecolentry
    \def\secondColumn{#2}
    \setcolumnwidth{\fill, 4.25cm}
    \begin{paracol}{2}
}{
    \switchcolumn \raggedleft \secondColumn
    \end{paracol}
    \endonecolentry
}

% -----------------------------------------------------------------
% Specialized Section Environments
% -----------------------------------------------------------------
% 1. Education Entry Environment
% Parameters: #1=Degree, #2=Institution, #3=Date Range
\newenvironment{educationentry}[3]{%
    \begin{samepage}
    \vspace{\entrySpacing}
    \begin{twocolentry}{#3}
        \mbox{\textbf{#1}
            \kern \kernSpacing
            \AND
            \kern \kernSpacing}
        \mbox{#2}
    \end{twocolentry}
    
    \vspace{\highlightSpacing}
    \begin{onecolentry}
        \begin{highlightsforbulletentries}
}{%
        \end{highlightsforbulletentries}
    \end{onecolentry}
    \end{samepage}
}

% 2. Experience Entry Environment (for Teaching, Industry, etc.)
% Parameters: #1=Title/Position, #2=Organization, #3=Location, #4=Date Range
\newenvironment{experienceentry}[4]{%
    \begin{samepage}
    \vspace{\entrySpacing}
    \begin{twocolentry}{#4}
        \mbox{\textbf{#1}
            \kern \kernSpacing
            \AND
            \kern \kernSpacing}
        \mbox{#2, #3}
    \end{twocolentry}
    
    \vspace{\highlightSpacing}
    \begin{onecolentry}
        \begin{highlightsforbulletentries}
}{%
        \end{highlightsforbulletentries}
    \end{onecolentry}
    \end{samepage}
}

% 3. Research Experience Entry Environment
% Parameters: #1=Project Title (with href), #2=Organization, #3=Location, 
%             #4=Course/Context, #5=Date
\newenvironment{researchentry}[5]{%
    \begin{samepage}
    \vspace{\entrySpacing}
    \mbox{\textbf{#1}
        \kern \kernSpacing
        \AND
        \kern \kernSpacing}
    \mbox{#2, #3}
    
    \vspace{\highlightSpacing}
    \begin{twocolentry}{#5}
        \mbox{\textit{#4}}
    \end{twocolentry}
    
    \begin{onecolentry}
        \begin{highlightsforbulletentries}
}{%
        \end{highlightsforbulletentries}
    \end{onecolentry}
    \end{samepage}
}

% 4. Project Entry Environment
% Parameters: #1=Project Title (with href), #2=Organization, #3=Location, #4=Date
\newenvironment{projectentry}[4]{%
    \begin{samepage}
    \vspace{\entrySpacing}
    \begin{twocolentry}{#4}
        \mbox{\textbf{#1}
            \kern \kernSpacing
            \AND
            \kern \kernSpacing}
        \mbox{#2, #3}
    \end{twocolentry}
    
    \vspace{\highlightSpacing}
    \begin{onecolentry}
        \begin{highlightsforbulletentries}
}{%
        \end{highlightsforbulletentries}
    \end{onecolentry}
    \end{samepage}
}

% 5. Leadership Entry Environment (for organization header)
% Parameters: #1=Organization, #2=Location
\newenvironment{leadershipentry}[2]{%
    \begin{samepage}
    \vspace{\entrySpacing}
    \mbox{\textbf{#1}
        \kern \kernSpacing
        \AND
        \kern \kernSpacing}
    \mbox{#2}
}{%
    \end{samepage}
}

% 5a. Position Entry Environment (for use within leadershipentry)
% Parameters: #1=Position, #2=Date Range
\newenvironment{positionentry}[2]{%
    \vspace{\highlightSpacing}
    \begin{twocolentry}{#2}
        \textit{#1}
    \end{twocolentry}
    
    \begin{onecolentry}
        \begin{highlightsforbulletentries}
}{%
        \end{highlightsforbulletentries}
    \end{onecolentry}
}

% 6. Skills Category Environment
% Parameter: #1=Category Name
\newenvironment{skillcategory}[1]{%
    \begin{samepage}
    \vspace{\highlightSpacing}
    \begin{onecolentry}
        \textbf{#1:} 
}{%
    \end{onecolentry}
    \end{samepage}
}

% 7. Honor/Award Entry Environment
% Parameters: #1=Date/Year, #2=Honor Name and Institution
\newenvironment{honorentry}[2]{%
    \begin{samepage}
    \vspace{\highlightSpacing}
    \begin{honorstwocolentry}{#1}
        \mbox{#2}
    \end{honorstwocolentry}
    \end{samepage}
}

% 8. Presentation Entry Environment
% Parameters: #1=Date, #2=Title, #3=Venue/Event, #4=University/Location
\newenvironment{presentationentry}[4]{%
    \begin{samepage}
    \vspace{\highlightSpacing}
    \begin{twocolentry}{#1}
        \mbox{\textbf{#2}}\\ \textit{#3}, #4
    \end{twocolentry}
    \end{samepage}
}

% -----------------------------------------------------------------
% Utility Commands
% -----------------------------------------------------------------
% Command to place "Last updated" text in the document
\newcommand{\placelastupdatedtext}{
  \AddToShipoutPictureFG*{
    \put(
        \LenToUnit{\paperwidth-2 cm-0 cm+0.05cm},
        \LenToUnit{\paperheight-1.0 cm}
    ){\vtop{{\null}\makebox[0pt][c]{
        \small\color{gray}\textit{Last updated in May 2025}\hspace{\widthof{Last updated in May 2025}}
    }}}
  }
}

% Define hyperref without arrows
\let\hrefWithoutArrow\href

% Define a separator for inline elements (appears as a vertical bar)
\newsavebox\ANDbox
\sbox\ANDbox{$|$}
\newcommand{\AND}{\unskip
    \cleaders\copy\ANDbox\hskip\wd\ANDbox
    \ignorespaces
}